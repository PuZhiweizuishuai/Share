import{_ as g,a as V}from"./show-html-BgEM3lMr.js";import{_,c as n,w as o,V as x,o as u,b as l,h as m,e as p,d as c,i as C,j as h,m as K,k as d,v as D,x as T,u as $}from"./index-C9n_ULeM.js";import{V as y,b as S,a as v,c as R}from"./VCard-5xhk0LXJ.js";const b={components:{ShowMarkdown:V,ShowHtml:g},data(){return{item:{data:"",editType:0},userSeeKey:"",showShareDialog:!1,showShareRes:!1,editKey:0}},created(){this.getShare()},mounted(){},methods:{getShare(){this.httpGet(`/public/share/check?id=${this.$route.params.id}`,i=>{i.status==200?i.data?this.showShareDialog=!0:this.getShareData():this.$router.push("/")})},getShareData(){this.httpPost("/public/share/get",{url:this.$route.params.id,userSeeKey:this.userSeeKey},i=>{i.data!=null&&(this.item=i.data,this.editKey++,this.showShareRes=!0,this.showShareDialog=!1)})},addLinkKey(){let i=document.querySelectorAll("video");for(let e=0;e<i.length;e++)i[e].src.includes(`${location.origin}/api/upload/file/`)&&(i[e].src=`${i[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let t=document.querySelectorAll("img");for(let e=0;e<t.length;e++)t[e].src.includes(`${location.origin}/api/upload/file/`)&&(t[e].src=`${t[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let s=document.querySelectorAll("a");for(let e=0;e<s.length;e++)s[e].href.includes(`${location.origin}/api/upload/file/`)&&(s[e].href=`${s[e].href}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let a=document.querySelectorAll("source");for(let e=0;e<a.length;e++)a[e].src.includes(`${location.origin}/api/upload/file/`)&&(a[e].src=`${a[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`)}}};function L(i,t,s,a,e,f){const k=g,w=V;return u(),n(x,null,{default:o(()=>[l(p),l(c,{justify:"center"},{default:o(()=>[l(C,{text:"为保护媒体资源，如果视频或图片不显示，请点击此按钮"},{activator:o(({props:r})=>[l(h,K({onClick:t[0]||(t[0]=U=>f.addLinkKey()),color:"blue"},r),{default:o(()=>t[5]||(t[5]=[d(" 加载 ")])),_:2},1040)]),_:1})]),_:1}),l(p),e.showShareRes?(u(),n(y,{key:0},{default:o(()=>[l(S,null,{default:o(()=>[e.item.editType==1?(u(),n(k,{text:e.item.data,key:e.editKey},null,8,["text"])):m("",!0),e.item.editType==0?(u(),n(w,{markdown:e.item.data,speech:!1,key:e.editKey},null,8,["markdown"])):m("",!0)]),_:1})]),_:1})):m("",!0),l(D,{persistent:"",modelValue:e.showShareDialog,"onUpdate:modelValue":t[4]||(t[4]=r=>e.showShareDialog=r),"max-width":"490"},{default:o(()=>[l(y,null,{default:o(()=>[l(v,{class:"headline"},{default:o(()=>t[6]||(t[6]=[d("请输入密码")])),_:1}),l(S,null,{default:o(()=>[l(c,{justify:"center"},{default:o(()=>[l(p,null,{default:o(()=>[l(T,{modelValue:e.userSeeKey,"onUpdate:modelValue":t[1]||(t[1]=r=>e.userSeeKey=r),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(R,null,{default:o(()=>[l($),l(h,{color:"green darken-1",text:"",onClick:t[2]||(t[2]=r=>e.showShareDialog=!1)},{default:o(()=>t[7]||(t[7]=[d(" 放弃 ")])),_:1}),l(h,{color:"error",text:"",onClick:t[3]||(t[3]=r=>f.getShareData())},{default:o(()=>t[8]||(t[8]=[d(" 确认 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const B=_(b,[["render",L]]);export{B as default};
