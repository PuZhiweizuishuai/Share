import{_ as g,a as _}from"./show-html-DvOe5WxL.js";import{_ as w,c as n,w as o,V as x,o as u,a as t,b as c,a8 as C,R as h,x as K,S as d,e as f,ac as m,ae as D,a6 as R,ad as T}from"./index-LAgYRP5B.js";import{V as y,b as S,a as $,c as b}from"./VCard-Bnv4al4g.js";const v={components:{ShowMarkdown:g,ShowHtml:_},data(){return{item:{data:"",editType:0},userSeeKey:"",showShareDialog:!1,showShareRes:!1,editKey:0}},created(){this.getShare()},mounted(){},methods:{getShare(){this.httpGet(`/public/share/check?id=${this.$route.params.id}`,i=>{i.status==200?i.data?this.showShareDialog=!0:this.getShareData():this.$router.push("/")})},getShareData(){this.httpPost("/public/share/get",{url:this.$route.params.id,userSeeKey:this.userSeeKey},i=>{i.data!=null&&(this.item=i.data,this.editKey++,this.showShareRes=!0,this.showShareDialog=!1)})},addLinkKey(){let i=document.querySelectorAll("video");for(let e=0;e<i.length;e++)i[e].src.includes(`${location.origin}/api/upload/file/`)&&(i[e].src=`${i[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let l=document.querySelectorAll("img");for(let e=0;e<l.length;e++)l[e].src.includes(`${location.origin}/api/upload/file/`)&&(l[e].src=`${l[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let r=document.querySelectorAll("a");for(let e=0;e<r.length;e++)r[e].href.includes(`${location.origin}/api/upload/file/`)&&(r[e].href=`${r[e].href}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let s=document.querySelectorAll("source");for(let e=0;e<s.length;e++)s[e].src.includes(`${location.origin}/api/upload/file/`)&&(s[e].src=`${s[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`)}}};function L(i,l,r,s,e,p){const V=_,k=g;return u(),n(x,null,{default:o(()=>[t(c),t(f,{justify:"center"},{default:o(()=>[t(C,{text:"为保护媒体资源，如果视频或图片不显示，请点击此按钮"},{activator:o(({props:a})=>[t(h,K({onClick:l[0]||(l[0]=U=>p.addLinkKey()),color:"blue"},a),{default:o(()=>[d(" 加载 ")]),_:2},1040)]),_:1})]),_:1}),t(c),e.showShareRes?(u(),n(y,{key:0},{default:o(()=>[t(S,null,{default:o(()=>[e.item.editType==1?(u(),n(V,{text:e.item.data,key:e.editKey},null,8,["text"])):m("",!0),e.item.editType==0?(u(),n(k,{markdown:e.item.data,speech:!1,key:e.editKey},null,8,["markdown"])):m("",!0)]),_:1})]),_:1})):m("",!0),t(T,{modelValue:e.showShareDialog,"onUpdate:modelValue":l[4]||(l[4]=a=>e.showShareDialog=a),"max-width":"490"},{default:o(()=>[t(y,null,{default:o(()=>[t($,{class:"headline"},{default:o(()=>[d("请输入密码")]),_:1}),t(S,null,{default:o(()=>[t(f,{justify:"center"},{default:o(()=>[t(c,null,{default:o(()=>[t(D,{modelValue:e.userSeeKey,"onUpdate:modelValue":l[1]||(l[1]=a=>e.userSeeKey=a),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(b,null,{default:o(()=>[t(R),t(h,{color:"green darken-1",text:"",onClick:l[2]||(l[2]=a=>e.showShareDialog=!1)},{default:o(()=>[d(" 放弃 ")]),_:1}),t(h,{color:"error",text:"",onClick:l[3]||(l[3]=a=>p.getShareData())},{default:o(()=>[d(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const B=w(v,[["render",L]]);export{B as default};
