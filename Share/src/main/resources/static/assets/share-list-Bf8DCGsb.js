import{S as H,a as N}from"./show-html-Bij7673F.js";import{_ as P,o as i,c,w as t,a as e,h as F,k as z,F as A,f as n,b as d,t as m,e as E,v as G,i as D,r,m as Y}from"./index-lJKHgFaS.js";const q={name:"ShareList",components:{ShowMarkdown:H,ShowHtml:N},props:{shareList:{type:Array,default:()=>[]}},data(){return{page:1,length:0,size:15,total:0,showDelete:!1,deleteData:{data:""},auto:!1,snackbar:!1,message:"删除成功",key:"",interval:()=>null,showShareDialog:!1,shareItem:{haveUserSeeKey:!1,userSeeKey:""},showseccussShareDialog:!1,successShareInfo:"",showShareBtn:!1,showShareStatusDilog:!1,showShareStatusItem:{}}},created(){this.checkLogin()},methods:{cancelShare(){this.showShareStatusItem.data="",this.httpPost("/public/share/cancel",this.showShareStatusItem,o=>{o.data?(this.message="取消成功",this.snackbar=!0,this.showShareStatusItem.publicUser=!1,this.showShareStatusDilog=!1):(this.message="取消失败",this.snackbar=!0,this.showShareStatusDilog=!1)})},showShareStatus(o){this.showShareStatusItem=o,this.successShareInfo=`链接：${location.origin}/share/share/${this.showShareStatusItem.url}`,this.showShareStatusItem.haveUserSeeKey&&(this.successShareInfo+=`
密码：${this.showShareStatusItem.userSeeKey}`),this.showShareStatusDilog=!0},checkLogin(){this.httpGet("/login/check",o=>{o.status==200?this.showShareBtn=!0:this.showShareBtn=!1})},showShareInfo(o){this.showShareDialog=!0,this.shareItem=o},sendSaveShare(){this.httpPost("/public/share",this.shareItem,o=>{o.data!=null?(this.successShareInfo=`链接：${location.href}share/share/${o.data.url}`,this.shareItem.haveUserSeeKey&&(this.successShareInfo+=`
密码：${this.shareItem.userSeeKey}`),this.showseccussShareDialog=!0,this.showShareDialog=!1):(this.message=o.message,this.snackbar=!0)})},deleteShare(){this.httpPost("/share/delete",this.deleteData,o=>{o.status===200?(this.message="删除成功！",this.snackbar=!0,this.showDelete=!1,this.$emit("delete",!0)):(this.message="删除失败！"+o.message,this.snackbar=!0,this.$emit("delete",!1))})},showDeleteDialog(o){this.deleteData=o,this.showDelete=!0},formateTimeToChinese(o){if(o===""||o==null)return"";const s=new Date(o);return s.getFullYear()+"年"+(s.getMonth()+1)+"月"+s.getDate()+"日 "+s.getHours()+"时"+s.getMinutes()+"分"},subString(o){return o.length>30?o.substring(0,30)+"......":o}}},J=["textContent"],O=["textContent"],Q=d("br",null,null,-1),R=d("br",null,null,-1),W=["textContent"],X=d("br",null,null,-1);function Z(o,s,y,j,a,u){const I=r("v-list-item-title"),f=r("v-col"),k=r("v-icon"),h=r("v-btn"),V=r("v-tooltip"),p=r("v-row"),w=r("v-card-actions"),C=r("v-divider"),U=r("ShowHtml"),K=r("ShowMarkdown"),_=r("v-card-text"),S=r("v-card"),g=r("v-card-title"),b=r("v-spacer"),v=r("v-dialog"),B=r("v-switch"),L=r("v-text-field"),T=r("v-snackbar"),M=r("v-container");return i(),c(M,null,{default:t(()=>[e(p,null,{default:t(()=>[(i(!0),F(A,null,z(y.shareList,l=>(i(),c(f,{key:l.id,cols:"12"},{default:t(()=>[e(S,null,{default:t(()=>[e(w,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:t(()=>[e(p,null,{default:t(()=>[e(f,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:t(()=>[e(I,null,{default:t(()=>[n("创建时间： "),d("span",{textContent:m(u.formateTimeToChinese(l.createTime))},null,8,J)]),_:2},1024)]),_:2},1024),e(f,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:t(()=>[e(h,{style:{float:"right"},end:"",text:"",small:"",color:"error",onClick:x=>u.showDeleteDialog(l)},{default:t(()=>[e(k,{icon:"mdi-delete"}),n(" 删除 ")]),_:2},1032,["onClick"]),a.showShareBtn&&(l.publicUser==!1||l.publicUser==null)?(i(),c(h,{key:0,onClick:x=>u.showShareInfo(l),style:{float:"right"},end:"",text:"",small:"",color:"blue"},{default:t(()=>[e(k,{icon:"mdi-share"}),n(" 分享 ")]),_:2},1032,["onClick"])):D("",!0),l.publicUser?(i(),c(V,{key:1,location:"top",text:"点击查看共享状态"},{activator:t(({props:x})=>[e(h,Y({ref_for:!0},x,{onClick:$=>u.showShareStatus(l),style:{float:"right"},small:"",color:"deep-purple"}),{default:t(()=>[e(k,{icon:"mdi-information-slab-symbol"}),n(" 已共享 ")]),_:2},1040,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(C),e(_,null,{default:t(()=>[l.editType==1?(i(),c(U,{key:0,text:l.data},null,8,["text"])):(i(),c(K,{key:1,markdown:l.data,speech:!1},null,8,["markdown"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(v,{modelValue:a.showDelete,"onUpdate:modelValue":s[2]||(s[2]=l=>a.showDelete=l),"max-width":"490"},{default:t(()=>[e(S,null,{default:t(()=>[e(g,{class:"headline"},{default:t(()=>[n("你确定要删除这条分享吗？")]),_:1}),e(_,null,{default:t(()=>[d("span",{textContent:m(u.subString(a.deleteData.data))},null,8,O),n(),Q,R,n(" 删除后将无法恢复，请谨慎操作！！！ ")]),_:1}),e(w,null,{default:t(()=>[e(b),e(h,{color:"green darken-1",text:"",onClick:s[0]||(s[0]=l=>a.showDelete=!1)},{default:t(()=>[n(" 放弃 ")]),_:1}),e(h,{color:"error",text:"",onClick:s[1]||(s[1]=l=>u.deleteShare())},{default:t(()=>[n(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(v,{modelValue:a.showShareDialog,"onUpdate:modelValue":s[7]||(s[7]=l=>a.showShareDialog=l),"max-width":"490"},{default:t(()=>[e(S,null,{default:t(()=>[e(g,{class:"headline"},{default:t(()=>[n("你要将这条分享出去吗？")]),_:1}),e(_,null,{default:t(()=>[d("p",null,[d("span",{textContent:m(u.subString(a.shareItem.data))},null,8,W),X,n(" 分享后在任何人均可查看 ")]),d("p",null,[e(p,{justify:"center"},{default:t(()=>[e(f,null,{default:t(()=>[e(B,{modelValue:a.shareItem.haveUserSeeKey,"onUpdate:modelValue":s[3]||(s[3]=l=>a.shareItem.haveUserSeeKey=l),color:"blue",label:"是否启用密码"},null,8,["modelValue"])]),_:1})]),_:1}),E(e(p,{justify:"center"},{default:t(()=>[e(f,null,{default:t(()=>[e(L,{modelValue:a.shareItem.userSeeKey,"onUpdate:modelValue":s[4]||(s[4]=l=>a.shareItem.userSeeKey=l),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1},512),[[G,a.shareItem.haveUserSeeKey]])])]),_:1}),e(w,null,{default:t(()=>[e(b),e(h,{color:"green darken-1",text:"",onClick:s[5]||(s[5]=l=>a.showShareDialog=!1)},{default:t(()=>[n(" 放弃 ")]),_:1}),e(h,{color:"error",text:"",onClick:s[6]||(s[6]=l=>u.sendSaveShare())},{default:t(()=>[n(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(v,{modelValue:a.showseccussShareDialog,"onUpdate:modelValue":s[8]||(s[8]=l=>a.showseccussShareDialog=l),"max-width":"490"},{default:t(()=>[e(S,null,{default:t(()=>[e(g,{class:"headline"},{default:t(()=>[n("分享成功，复制下面内容给你的好友吧！")]),_:1}),e(_,null,{default:t(()=>[n(m(a.successShareInfo),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(v,{modelValue:a.showShareStatusDilog,"onUpdate:modelValue":s[11]||(s[11]=l=>a.showShareStatusDilog=l),"max-width":"490"},{default:t(()=>[e(S,null,{default:t(()=>[e(g,{class:"headline"},{default:t(()=>[n("分享状态")]),_:1}),e(_,null,{default:t(()=>[n(m(a.successShareInfo),1)]),_:1}),e(w,null,{default:t(()=>[e(b),e(h,{color:"green darken-1",text:"",onClick:s[9]||(s[9]=l=>a.showShareStatusDilog=!1)},{default:t(()=>[n(" 关闭 ")]),_:1}),a.showShareBtn?(i(),c(h,{key:0,color:"error",text:"",onClick:s[10]||(s[10]=l=>u.cancelShare())},{default:t(()=>[n(" 取消分享 ")]),_:1})):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(T,{modelValue:a.snackbar,"onUpdate:modelValue":s[12]||(s[12]=l=>a.snackbar=l),color:"success",timeout:3e3,top:!0},{default:t(()=>[n(m(a.message),1)]),_:1},8,["modelValue"])]),_:1})}const se=P(q,[["render",Z]]);export{se as S};
