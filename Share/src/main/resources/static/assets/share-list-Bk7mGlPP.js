import{_ as C,a as I}from"./show-html-BtmOX4IU.js";import{a as K}from"./view-log-list-C9rkRqke.js";import{_ as L,c as m,w as l,V as _,r as F,o as d,b as t,d as h,l as M,F as N,A as P,e as i,B as A,k as r,a as f,t as S,h as D,j as u,C as x,i as H,m as z,f as E,v as w,u as y,g as G,x as R,y as Y,z as j}from"./index-DDk1_yXq.js";import{V as g,c as V,b as p,a as k}from"./VCard-C8mrYAc5.js";import{V as q}from"./VSwitch-D6VxJ_2I.js";const J={name:"ShareList",components:{ShowMarkdown:I,ShowHtml:C,ViewLogTable:K},props:{shareList:{type:Array,default:()=>[]}},data(){return{page:1,length:0,size:15,total:0,showDelete:!1,deleteData:{data:""},auto:!1,snackbar:!1,message:"删除成功",key:"",interval:()=>null,showShareDialog:!1,shareItem:{haveUserSeeKey:!1,userSeeKey:""},showseccussShareDialog:!1,successShareInfo:"",showShareBtn:!1,showShareStatusDilog:!1,showShareStatusItem:{}}},created(){this.checkLogin()},methods:{copy(){navigator.clipboard.writeText(this.successShareInfo)},cancelShare(){this.showShareStatusItem.data="",this.httpPost("/public/share/cancel",this.showShareStatusItem,o=>{o.data?(this.message="取消成功",this.snackbar=!0,this.showShareStatusItem.publicUser=!1,this.showShareStatusDilog=!1):(this.message="取消失败",this.snackbar=!0,this.showShareStatusDilog=!1)})},showShareStatus(o){this.showShareStatusItem=o,this.successShareInfo=`链接：${location.origin}/#/share/share/${this.showShareStatusItem.url}`,this.showShareStatusItem.haveUserSeeKey&&(this.successShareInfo+=`
密码：${this.showShareStatusItem.userSeeKey}`),this.showShareStatusDilog=!0},checkLogin(){this.httpGet("/login/check",o=>{o.status==200?this.showShareBtn=!0:this.showShareBtn=!1})},showShareInfo(o){this.showShareDialog=!0,this.shareItem=o},sendSaveShare(){this.httpPost("/public/share",this.shareItem,o=>{o.data!=null?(this.successShareInfo=`链接：${location.origin}/#/share/share/${o.data.url}`,this.shareItem.haveUserSeeKey&&(this.successShareInfo+=`
密码：${this.shareItem.userSeeKey}`),this.showseccussShareDialog=!0,this.showShareDialog=!1):(this.message=o.message,this.snackbar=!0)})},deleteShare(){this.httpPost("/share/delete",this.deleteData,o=>{o.status===200?(this.message="删除成功！",this.snackbar=!0,this.showDelete=!1,this.$emit("delete",!0)):(this.message="删除失败！"+o.message,this.snackbar=!0,this.$emit("delete",!1))})},showDeleteDialog(o){this.deleteData=o,this.showDelete=!0},formateTimeToChinese(o){if(o===""||o==null)return"";const e=new Date(o);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日 "+e.getHours()+"时"+e.getMinutes()+"分"},subString(o){return o.length>30?o.substring(0,30)+"......":o}}},O=["textContent"],Q=["textContent"],W=["textContent"];function X(o,e,v,Z,a,n){const U=C,T=I,B=F("ViewLogTable");return d(),m(_,null,{default:l(()=>[t(h,null,{default:l(()=>[(d(!0),M(N,null,P(v.shareList,s=>(d(),m(i,{key:s.id,cols:"12"},{default:l(()=>[t(g,null,{default:l(()=>[t(V,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:l(()=>[t(h,null,{default:l(()=>[t(i,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:l(()=>[t(A,null,{default:l(()=>[e[15]||(e[15]=r("创建时间： ")),f("span",{textContent:S(n.formateTimeToChinese(s.createTime))},null,8,O)]),_:2},1024)]),_:2},1024),t(i,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:l(()=>[t(u,{style:{float:"right"},end:"",text:"",small:"",color:"error",onClick:b=>n.showDeleteDialog(s)},{default:l(()=>[t(x,{icon:"mdi-delete"}),e[16]||(e[16]=r(" 删除 "))]),_:2},1032,["onClick"]),a.showShareBtn&&(s.publicUser==!1||s.publicUser==null)?(d(),m(u,{key:0,onClick:b=>n.showShareInfo(s),style:{float:"right"},end:"",text:"",small:"",color:"blue"},{default:l(()=>[t(x,{icon:"mdi-share"}),e[17]||(e[17]=r(" 分享 "))]),_:2},1032,["onClick"])):D("",!0),s.publicUser?(d(),m(H,{key:1,location:"top",text:"点击查看共享状态"},{activator:l(({props:b})=>[t(u,z({ref_for:!0},b,{onClick:c=>n.showShareStatus(s),style:{float:"right"},small:"",color:"deep-purple"}),{default:l(()=>[t(x,{icon:"mdi-information-slab-symbol"}),e[18]||(e[18]=r(" 已共享 "))]),_:2},1040,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(E),t(p,null,{default:l(()=>[s.editType==1?(d(),m(U,{key:0,text:s.data},null,8,["text"])):(d(),m(T,{key:1,markdown:s.data,speech:!1},null,8,["markdown"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(w,{modelValue:a.showDelete,"onUpdate:modelValue":e[2]||(e[2]=s=>a.showDelete=s),"max-width":"490"},{default:l(()=>[t(g,null,{default:l(()=>[t(k,{class:"headline"},{default:l(()=>e[19]||(e[19]=[r("你确定要删除这条分享吗？")])),_:1}),t(p,null,{default:l(()=>[f("span",{textContent:S(n.subString(a.deleteData.data))},null,8,Q),e[20]||(e[20]=r()),e[21]||(e[21]=f("br",null,null,-1)),e[22]||(e[22]=f("br",null,null,-1)),e[23]||(e[23]=r(" 删除后将无法恢复，请谨慎操作！！！ "))]),_:1}),t(V,null,{default:l(()=>[t(y),t(u,{color:"green darken-1",text:"",onClick:e[0]||(e[0]=s=>a.showDelete=!1)},{default:l(()=>e[24]||(e[24]=[r(" 放弃 ")])),_:1}),t(u,{color:"error",text:"",onClick:e[1]||(e[1]=s=>n.deleteShare())},{default:l(()=>e[25]||(e[25]=[r(" 确认 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(w,{modelValue:a.showShareDialog,"onUpdate:modelValue":e[7]||(e[7]=s=>a.showShareDialog=s),"max-width":"490"},{default:l(()=>[t(g,null,{default:l(()=>[t(k,{class:"headline"},{default:l(()=>e[26]||(e[26]=[r("你要将这条分享出去吗？")])),_:1}),t(p,null,{default:l(()=>[f("p",null,[f("span",{textContent:S(n.subString(a.shareItem.data))},null,8,W),e[27]||(e[27]=f("br",null,null,-1)),e[28]||(e[28]=r(" 分享后在任何人均可查看 "))]),f("p",null,[t(h,{justify:"center"},{default:l(()=>[t(i,null,{default:l(()=>[t(q,{modelValue:a.shareItem.haveUserSeeKey,"onUpdate:modelValue":e[3]||(e[3]=s=>a.shareItem.haveUserSeeKey=s),color:"blue",label:"是否启用密码"},null,8,["modelValue"])]),_:1})]),_:1}),G(t(h,{justify:"center"},{default:l(()=>[t(i,null,{default:l(()=>[t(R,{modelValue:a.shareItem.userSeeKey,"onUpdate:modelValue":e[4]||(e[4]=s=>a.shareItem.userSeeKey=s),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1},512),[[Y,a.shareItem.haveUserSeeKey]])])]),_:1}),t(V,null,{default:l(()=>[t(y),t(u,{color:"green darken-1",text:"",onClick:e[5]||(e[5]=s=>a.showShareDialog=!1)},{default:l(()=>e[29]||(e[29]=[r(" 放弃 ")])),_:1}),t(u,{color:"error",text:"",onClick:e[6]||(e[6]=s=>n.sendSaveShare())},{default:l(()=>e[30]||(e[30]=[r(" 确认 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(w,{modelValue:a.showseccussShareDialog,"onUpdate:modelValue":e[9]||(e[9]=s=>a.showseccussShareDialog=s),"max-width":"490"},{default:l(()=>[t(g,null,{default:l(()=>[t(k,{class:"headline"},{default:l(()=>e[31]||(e[31]=[r("分享成功，复制下面内容给你的好友吧！")])),_:1}),t(p,null,{default:l(()=>[t(h,null,{default:l(()=>[t(i,null,{default:l(()=>[r(S(a.successShareInfo),1)]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(i,null,{default:l(()=>[t(u,{color:"blue-lighten-5",onClick:e[8]||(e[8]=s=>n.copy())},{default:l(()=>e[32]||(e[32]=[r("复制")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(w,{modelValue:a.showShareStatusDilog,"onUpdate:modelValue":e[13]||(e[13]=s=>a.showShareStatusDilog=s),"max-width":"1000"},{default:l(()=>[t(g,null,{default:l(()=>[t(k,{class:"headline"},{default:l(()=>e[33]||(e[33]=[r("分享状态")])),_:1}),t(p,null,{default:l(()=>[t(h,null,{default:l(()=>[t(i,null,{default:l(()=>[r(S(a.successShareInfo),1)]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(i,null,{default:l(()=>[t(u,{color:"blue-lighten-5",onClick:e[10]||(e[10]=s=>n.copy())},{default:l(()=>e[34]||(e[34]=[r("复制")])),_:1})]),_:1})]),_:1}),t(B,{target:a.showShareStatusItem.id,types:0},null,8,["target"])]),_:1}),t(V,null,{default:l(()=>[t(y),t(u,{color:"green darken-1",text:"",onClick:e[11]||(e[11]=s=>a.showShareStatusDilog=!1)},{default:l(()=>e[35]||(e[35]=[r(" 关闭 ")])),_:1}),a.showShareBtn?(d(),m(u,{key:0,color:"error",text:"",onClick:e[12]||(e[12]=s=>n.cancelShare())},{default:l(()=>e[36]||(e[36]=[r(" 取消分享 ")])),_:1})):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(j,{modelValue:a.snackbar,"onUpdate:modelValue":e[14]||(e[14]=s=>a.snackbar=s),color:"success",timeout:3e3,top:!0},{default:l(()=>[r(S(a.message),1)]),_:1},8,["modelValue"])]),_:1})}const ae=L(J,[["render",X]]);export{ae as S};
