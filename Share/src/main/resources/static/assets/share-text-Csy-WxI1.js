import{_ as g,a as _}from"./show-html-7-6MaXIJ.js";import{_ as w,c as n,w as o,V as x,o as u,a as t,b as c,m as C,k as h,s as K,i as d,e as f,u as m,x as D,j as T,v as $}from"./index-eEThDJPZ.js";import{V as y,b as S,a as v,c as R}from"./VCard-Cr7mm8p2.js";const b={components:{ShowMarkdown:g,ShowHtml:_},data(){return{item:{data:"",editType:0},userSeeKey:"",showShareDialog:!1,showShareRes:!1,editKey:0}},created(){this.getShare()},mounted(){},methods:{getShare(){this.httpGet(`/public/share/check?id=${this.$route.params.id}`,i=>{i.status==200?i.data?this.showShareDialog=!0:this.getShareData():this.$router.push("/")})},getShareData(){this.httpPost("/public/share/get",{url:this.$route.params.id,userSeeKey:this.userSeeKey},i=>{i.data!=null&&(this.item=i.data,this.editKey++,this.showShareRes=!0,this.showShareDialog=!1)})},addLinkKey(){let i=document.querySelectorAll("video");for(let e=0;e<i.length;e++)i[e].src.includes(`${location.origin}/api/upload/file/`)&&(i[e].src=`${i[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let l=document.querySelectorAll("img");for(let e=0;e<l.length;e++)l[e].src.includes(`${location.origin}/api/upload/file/`)&&(l[e].src=`${l[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let a=document.querySelectorAll("a");for(let e=0;e<a.length;e++)a[e].href.includes(`${location.origin}/api/upload/file/`)&&(a[e].href=`${a[e].href}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let s=document.querySelectorAll("source");for(let e=0;e<s.length;e++)s[e].src.includes(`${location.origin}/api/upload/file/`)&&(s[e].src=`${s[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`)}}};function L(i,l,a,s,e,p){const V=_,k=g;return u(),n(x,null,{default:o(()=>[t(c),t(f,{justify:"center"},{default:o(()=>[t(C,{text:"为保护媒体资源，如果视频或图片不显示，请点击此按钮"},{activator:o(({props:r})=>[t(h,K({onClick:l[0]||(l[0]=U=>p.addLinkKey()),color:"blue"},r),{default:o(()=>[d(" 加载 ")]),_:2},1040)]),_:1})]),_:1}),t(c),e.showShareRes?(u(),n(y,{key:0},{default:o(()=>[t(S,null,{default:o(()=>[e.item.editType==1?(u(),n(V,{text:e.item.data,key:e.editKey},null,8,["text"])):m("",!0),e.item.editType==0?(u(),n(k,{markdown:e.item.data,speech:!1,key:e.editKey},null,8,["markdown"])):m("",!0)]),_:1})]),_:1})):m("",!0),t($,{persistent:"",modelValue:e.showShareDialog,"onUpdate:modelValue":l[4]||(l[4]=r=>e.showShareDialog=r),"max-width":"490"},{default:o(()=>[t(y,null,{default:o(()=>[t(v,{class:"headline"},{default:o(()=>[d("请输入密码")]),_:1}),t(S,null,{default:o(()=>[t(f,{justify:"center"},{default:o(()=>[t(c,null,{default:o(()=>[t(D,{modelValue:e.userSeeKey,"onUpdate:modelValue":l[1]||(l[1]=r=>e.userSeeKey=r),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(R,null,{default:o(()=>[t(T),t(h,{color:"green darken-1",text:"",onClick:l[2]||(l[2]=r=>e.showShareDialog=!1)},{default:o(()=>[d(" 放弃 ")]),_:1}),t(h,{color:"error",text:"",onClick:l[3]||(l[3]=r=>p.getShareData())},{default:o(()=>[d(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const B=w(b,[["render",L]]);export{B as default};
