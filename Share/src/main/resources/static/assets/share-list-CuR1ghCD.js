import{_ as x,a as y}from"./show-html-DusctlBV.js";import{_ as U,o as h,c as d,w as t,a as e,ab as T,aj as K,O as B,e as g,S as r,d as i,t as f,a6 as k,R as u,ad as w,b as S,a4 as L,af as P,ae as M,ac as D,ag as N,V as F,ak as H,P as b,a8 as A,x as R,f as z}from"./index-BM9dQ_g4.js";import{V as m,a as p,b as c,c as _}from"./VCard-ChEfXFhJ.js";import{V as E}from"./VPagination-DUlpAsWq.js";const G={name:"ShareList",components:{ShowMarkdown:x,ShowHtml:y},props:{shareList:{type:Array,default:()=>[]}},data(){return{page:1,length:0,size:15,total:0,showDelete:!1,deleteData:{data:""},auto:!1,snackbar:!1,message:"删除成功",key:"",interval:()=>null,showShareDialog:!1,shareItem:{haveUserSeeKey:!1,userSeeKey:""},showseccussShareDialog:!1,successShareInfo:"",showShareBtn:!1,showShareStatusDilog:!1,showShareStatusItem:{}}},created(){this.checkLogin()},methods:{cancelShare(){this.showShareStatusItem.data="",this.httpPost("/public/share/cancel",this.showShareStatusItem,a=>{a.data?(this.message="取消成功",this.snackbar=!0,this.showShareStatusItem.publicUser=!1,this.showShareStatusDilog=!1):(this.message="取消失败",this.snackbar=!0,this.showShareStatusDilog=!1)})},showShareStatus(a){this.showShareStatusItem=a,this.successShareInfo=`链接：${location.origin}/#/share/share/${this.showShareStatusItem.url}`,this.showShareStatusItem.haveUserSeeKey&&(this.successShareInfo+=`
密码：${this.showShareStatusItem.userSeeKey}`),this.showShareStatusDilog=!0},checkLogin(){this.httpGet("/login/check",a=>{a.status==200?this.showShareBtn=!0:this.showShareBtn=!1})},showShareInfo(a){this.showShareDialog=!0,this.shareItem=a},sendSaveShare(){this.httpPost("/public/share",this.shareItem,a=>{a.data!=null?(this.successShareInfo=`链接：${location.origin}/#/share/share/${a.data.url}`,this.shareItem.haveUserSeeKey&&(this.successShareInfo+=`
密码：${this.shareItem.userSeeKey}`),this.showseccussShareDialog=!0,this.showShareDialog=!1):(this.message=a.message,this.snackbar=!0)})},deleteShare(){this.httpPost("/share/delete",this.deleteData,a=>{a.status===200?(this.message="删除成功！",this.snackbar=!0,this.showDelete=!1,this.$emit("delete",!0)):(this.message="删除失败！"+a.message,this.snackbar=!0,this.$emit("delete",!1))})},showDeleteDialog(a){this.deleteData=a,this.showDelete=!0},formateTimeToChinese(a){if(a===""||a==null)return"";const s=new Date(a);return s.getFullYear()+"年"+(s.getMonth()+1)+"月"+s.getDate()+"日 "+s.getHours()+"时"+s.getMinutes()+"分"},subString(a){return a.length>30?a.substring(0,30)+"......":a}}},O=["textContent"],Y=["textContent"],j=i("br",null,null,-1),q=i("br",null,null,-1),J=["textContent"],Q=i("br",null,null,-1);function W(a,s,I,X,o,n){const C=y,v=x;return h(),d(F,null,{default:t(()=>[e(g,null,{default:t(()=>[(h(!0),T(B,null,K(I.shareList,l=>(h(),d(S,{key:l.id,cols:"12"},{default:t(()=>[e(m,null,{default:t(()=>[e(_,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:t(()=>[e(g,null,{default:t(()=>[e(S,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:t(()=>[e(H,null,{default:t(()=>[r("创建时间： "),i("span",{textContent:f(n.formateTimeToChinese(l.createTime))},null,8,O)]),_:2},1024)]),_:2},1024),e(S,{style:{"padding-bottom":"0px","padding-top":"0px"}},{default:t(()=>[e(u,{style:{float:"right"},end:"",text:"",small:"",color:"error",onClick:V=>n.showDeleteDialog(l)},{default:t(()=>[e(b,{icon:"mdi-delete"}),r(" 删除 ")]),_:2},1032,["onClick"]),o.showShareBtn&&(l.publicUser==!1||l.publicUser==null)?(h(),d(u,{key:0,onClick:V=>n.showShareInfo(l),style:{float:"right"},end:"",text:"",small:"",color:"blue"},{default:t(()=>[e(b,{icon:"mdi-share"}),r(" 分享 ")]),_:2},1032,["onClick"])):D("",!0),l.publicUser?(h(),d(A,{key:1,location:"top",text:"点击查看共享状态"},{activator:t(({props:V})=>[e(u,R({ref_for:!0},V,{onClick:Z=>n.showShareStatus(l),style:{float:"right"},small:"",color:"deep-purple"}),{default:t(()=>[e(b,{icon:"mdi-information-slab-symbol"}),r(" 已共享 ")]),_:2},1040,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(z),e(c,null,{default:t(()=>[l.editType==1?(h(),d(C,{key:0,text:l.data},null,8,["text"])):(h(),d(v,{key:1,markdown:l.data,speech:!1},null,8,["markdown"]))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(w,{modelValue:o.showDelete,"onUpdate:modelValue":s[2]||(s[2]=l=>o.showDelete=l),"max-width":"490"},{default:t(()=>[e(m,null,{default:t(()=>[e(p,{class:"headline"},{default:t(()=>[r("你确定要删除这条分享吗？")]),_:1}),e(c,null,{default:t(()=>[i("span",{textContent:f(n.subString(o.deleteData.data))},null,8,Y),r(),j,q,r(" 删除后将无法恢复，请谨慎操作！！！ ")]),_:1}),e(_,null,{default:t(()=>[e(k),e(u,{color:"green darken-1",text:"",onClick:s[0]||(s[0]=l=>o.showDelete=!1)},{default:t(()=>[r(" 放弃 ")]),_:1}),e(u,{color:"error",text:"",onClick:s[1]||(s[1]=l=>n.deleteShare())},{default:t(()=>[r(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:o.showShareDialog,"onUpdate:modelValue":s[7]||(s[7]=l=>o.showShareDialog=l),"max-width":"490"},{default:t(()=>[e(m,null,{default:t(()=>[e(p,{class:"headline"},{default:t(()=>[r("你要将这条分享出去吗？")]),_:1}),e(c,null,{default:t(()=>[i("p",null,[i("span",{textContent:f(n.subString(o.shareItem.data))},null,8,J),Q,r(" 分享后在任何人均可查看 ")]),i("p",null,[e(g,{justify:"center"},{default:t(()=>[e(S,null,{default:t(()=>[e(E,{modelValue:o.shareItem.haveUserSeeKey,"onUpdate:modelValue":s[3]||(s[3]=l=>o.shareItem.haveUserSeeKey=l),color:"blue",label:"是否启用密码"},null,8,["modelValue"])]),_:1})]),_:1}),L(e(g,{justify:"center"},{default:t(()=>[e(S,null,{default:t(()=>[e(M,{modelValue:o.shareItem.userSeeKey,"onUpdate:modelValue":s[4]||(s[4]=l=>o.shareItem.userSeeKey=l),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1},512),[[P,o.shareItem.haveUserSeeKey]])])]),_:1}),e(_,null,{default:t(()=>[e(k),e(u,{color:"green darken-1",text:"",onClick:s[5]||(s[5]=l=>o.showShareDialog=!1)},{default:t(()=>[r(" 放弃 ")]),_:1}),e(u,{color:"error",text:"",onClick:s[6]||(s[6]=l=>n.sendSaveShare())},{default:t(()=>[r(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:o.showseccussShareDialog,"onUpdate:modelValue":s[8]||(s[8]=l=>o.showseccussShareDialog=l),"max-width":"490"},{default:t(()=>[e(m,null,{default:t(()=>[e(p,{class:"headline"},{default:t(()=>[r("分享成功，复制下面内容给你的好友吧！")]),_:1}),e(c,null,{default:t(()=>[r(f(o.successShareInfo),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:o.showShareStatusDilog,"onUpdate:modelValue":s[11]||(s[11]=l=>o.showShareStatusDilog=l),"max-width":"490"},{default:t(()=>[e(m,null,{default:t(()=>[e(p,{class:"headline"},{default:t(()=>[r("分享状态")]),_:1}),e(c,null,{default:t(()=>[r(f(o.successShareInfo),1)]),_:1}),e(_,null,{default:t(()=>[e(k),e(u,{color:"green darken-1",text:"",onClick:s[9]||(s[9]=l=>o.showShareStatusDilog=!1)},{default:t(()=>[r(" 关闭 ")]),_:1}),o.showShareBtn?(h(),d(u,{key:0,color:"error",text:"",onClick:s[10]||(s[10]=l=>n.cancelShare())},{default:t(()=>[r(" 取消分享 ")]),_:1})):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(N,{modelValue:o.snackbar,"onUpdate:modelValue":s[12]||(s[12]=l=>o.snackbar=l),color:"success",timeout:3e3,top:!0},{default:t(()=>[r(f(o.message),1)]),_:1},8,["modelValue"])]),_:1})}const le=U(G,[["render",W]]);export{le as S};
