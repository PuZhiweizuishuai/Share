import{_ as w,c as h,w as l,V as k,o as f,g as x,y as b,a as e,b as t,e as r,f as m,x as d,k as c,i as o,bx as I,q as U,C,F as P,u as g,t as y,z as j,d as _,by as M,D as v}from"./index-BkN6O-Cq.js";import{V as p}from"./VCard-BBT-dtOV.js";const L={data(){return{user:{username:"",password:"",oldPassword:""},snackbar:!1,message:"",ipdata:"",items:[{createUser:"mdi-share",ip:"分享列表"},{createUser:"mdi-file",ip:"文件列表"},{createUser:"mdi-text",ip:"二维码分享"},{createUser:"mdi-lock",ip:"加密解密"},{createUser:"mdi-wrench",ip:"设置"},{createUser:"mdi-help",ip:"关于"}],loginUserInfo:{},showSysInfo:!1,showLogin:!0,fileMax:0}},created(){this.checkLogin()},methods:{checkLogin(){this.httpGet("/login/check",i=>{i.status==200?(this.showSysInfo=!0,this.showLogin=!1,this.getWhitelist(),this.getFileMax()):(this.showSysInfo=!1,this.showLogin=!0)})},userLogin(){this.httpPost("/login",this.user,i=>{i.data!=null&&i.data!=""?(this.loginUserInfo=i.data,this.showSysInfo=!0,this.showLogin=!1,this.getWhitelist(),this.getFileMax()):(this.message="登录失败",this.snackbar=!0)})},updatePassword(){this.httpPost("/admin/change/password",this.user,i=>{i.data!=null&&i.data!=""?(this.loginUserInfo=i.data,this.showSysInfo=!1,this.showLogin=!0):(this.message="修改失败",this.snackbar=!0)})},addWhitelIP(){this.httpPost("/admin/whitelist/add",this.ipdata,i=>{console.log(i),this.getWhitelist()})},getWhitelist(){this.httpGet("/admin/whitelist",i=>{this.items=i.data})},deleteIP(i){this.httpPost("/admin/whitelist/delete",i,u=>{this.getWhitelist()})},checkNumber(){return!(this.fileMax==null||isNaN(parseInt(this.fileMax)))},settingFileMax(){this.checkNumber()&&this.httpPost("/upload/setting/filemax?type=sysinfo",{uploadFileMax:this.fileMax},i=>{this.message=i.message,this.snackbar=!0})},getFileMax(){this.httpGet("/upload/disk",i=>{this.fileMax=i.data.uploadFileMax})}}},S=_("h2",null,"系统配置：",-1),F=_("h2",null,"IP白名单",-1),N=_("h2",null,"修改密码",-1),W=_("h2",null,"上传文件大小配置",-1);function B(i,u,D,G,s,n){return f(),h(k,null,{default:l(()=>[x(e(r,{justify:"center",align:"center"},{default:l(()=>[e(t,null,{default:l(()=>[e(p,{class:"mx-auto",outlined:""},{default:l(()=>[e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"10"},{default:l(()=>[S]),_:1})]),_:1}),e(m),e(t),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{modelValue:s.user.username,"onUpdate:modelValue":u[0]||(u[0]=a=>s.user.username=a),placeholder:"账号",label:"账号",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{modelValue:s.user.password,"onUpdate:modelValue":u[1]||(u[1]=a=>s.user.password=a),type:"password",placeholder:"密码",label:"密码",variant:"underlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{justify:"center"},{default:l(()=>[e(c,{onClick:n.userLogin,color:"blue"},{default:l(()=>[o(" 登录 ")]),_:1},8,["onClick"])]),_:1}),e(t)]),_:1})]),_:1})]),_:1},512),[[b,s.showLogin]]),s.showSysInfo?(f(),h(r,{key:0,justify:"center",align:"center"},{default:l(()=>[e(t,null,{default:l(()=>[e(p,{class:"mx-auto",outlined:""},{default:l(()=>[e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"10"},{default:l(()=>[F]),_:1})]),_:1}),e(m),e(t),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(I,{density:"compact"},{default:l(()=>[(f(!0),U(P,null,C(s.items,(a,V)=>(f(),h(M,{key:V,value:a,color:"primary"},{prepend:l(()=>[e(c,{color:"error",onClick:T=>n.deleteIP(a),style:{"margin-right":"32px"},density:"compact"},{default:l(()=>[o(" 删除 ")]),_:2},1032,["onClick"])]),default:l(()=>[e(v,null,{default:l(()=>[o(y(a.ip)+" - 创建人："+y(a.createUser),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1}),e(m),e(t),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{modelValue:s.ipdata,"onUpdate:modelValue":u[2]||(u[2]=a=>s.ipdata=a),placeholder:"IP",label:"IP",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"4"},{default:l(()=>[e(c,{onClick:n.getWhitelist},{default:l(()=>[o(" 刷新 ")]),_:1},8,["onClick"])]),_:1}),e(t,{cols:"4"},{default:l(()=>[e(c,{onClick:n.addWhitelIP,color:"green"},{default:l(()=>[o(" 增加 ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(t)]),_:1})]),_:1})]),_:1})):g("",!0),s.showSysInfo?(f(),h(r,{key:1,justify:"center",align:"center"},{default:l(()=>[e(t,null,{default:l(()=>[e(p,{class:"mx-auto",outlined:""},{default:l(()=>[e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"10"},{default:l(()=>[N]),_:1})]),_:1}),e(m),e(t),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{modelValue:s.user.username,"onUpdate:modelValue":u[3]||(u[3]=a=>s.user.username=a),placeholder:"账号",label:"账号",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{modelValue:s.user.oldPassword,"onUpdate:modelValue":u[4]||(u[4]=a=>s.user.oldPassword=a),type:"password",placeholder:"旧密码",label:"旧密码",variant:"underlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{modelValue:s.user.password,"onUpdate:modelValue":u[5]||(u[5]=a=>s.user.password=a),type:"password",placeholder:"新密码",label:"新密码",variant:"underlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{justify:"center"},{default:l(()=>[e(c,{onClick:n.updatePassword},{default:l(()=>[o(" 修改 ")]),_:1},8,["onClick"])]),_:1}),e(t)]),_:1})]),_:1})]),_:1})):g("",!0),s.showSysInfo?(f(),h(r,{key:2,justify:"center",align:"center"},{default:l(()=>[e(t,null,{default:l(()=>[e(p,{class:"mx-auto",outlined:""},{default:l(()=>[e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"10"},{default:l(()=>[W]),_:1})]),_:1}),e(m),e(t),e(r,{justify:"center"},{default:l(()=>[e(t,{cols:"8"},{default:l(()=>[e(d,{variant:"underlined",modelValue:s.fileMax,"onUpdate:modelValue":u[6]||(u[6]=a=>s.fileMax=a),placeholder:"上传文件最大大小（单位：M）",label:"上传文件最大大小（单位：M）",clearable:"",rules:[()=>n.checkNumber()||"必须是数字且不为空"]},null,8,["modelValue","rules"])]),_:1}),e(t,{cols:"2"},{default:l(()=>[e(c,{color:"primary",onClick:u[7]||(u[7]=a=>n.settingFileMax())},{default:l(()=>[o("修改")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),e(j,{modelValue:s.snackbar,"onUpdate:modelValue":u[8]||(u[8]=a=>s.snackbar=a),timeout:3e3,top:!0},{default:l(()=>[o(y(s.message),1)]),_:1},8,["modelValue"])]),_:1})}const E=w(L,[["render",B]]);export{E as default};
