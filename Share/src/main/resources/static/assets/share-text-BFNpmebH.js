import{S as $,a as b}from"./show-html-B8VADRer.js";import{_ as R,c,w as l,r as n,o as d,a as t,m as L,f as u,i as _}from"./index-BHqpIUYW.js";const U={components:{ShowMarkdown:$,ShowHtml:b},data(){return{item:{data:"",editType:0},userSeeKey:"",showShareDialog:!1,showShareRes:!1,editKey:0}},created(){this.getShare()},mounted(){},methods:{getShare(){this.httpGet(`/public/share/check?id=${this.$route.params.id}`,i=>{i.status==200?i.data?this.showShareDialog=!0:this.getShareData():this.$router.push("/")})},getShareData(){this.httpPost("/public/share/get",{url:this.$route.params.id,userSeeKey:this.userSeeKey},i=>{i.data!=null&&(this.item=i.data,this.editKey++,this.showShareRes=!0,this.showShareDialog=!1)})},addLinkKey(){let i=document.querySelectorAll("video");for(let e=0;e<i.length;e++)i[e].src.includes(`${location.origin}/api/upload/file/`)&&(i[e].src=`${i[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let o=document.querySelectorAll("img");for(let e=0;e<o.length;e++)o[e].src.includes(`${location.origin}/api/upload/file/`)&&(o[e].src=`${o[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let s=document.querySelectorAll("a");for(let e=0;e<s.length;e++)s[e].href.includes(`${location.origin}/api/upload/file/`)&&(s[e].href=`${s[e].href}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`);let a=document.querySelectorAll("source");for(let e=0;e<a.length;e++)a[e].src.includes(`${location.origin}/api/upload/file/`)&&(a[e].src=`${a[e].src}?type=inline&key=${encodeURIComponent(this.item.userSeeKey)}`)}}};function T(i,o,s,a,e,h){const m=n("v-col"),p=n("v-btn"),v=n("v-tooltip"),f=n("v-row"),g=n("ShowHtml"),w=n("ShowMarkdown"),y=n("v-card-text"),S=n("v-card"),k=n("v-card-title"),x=n("v-text-field"),K=n("v-spacer"),C=n("v-card-actions"),D=n("v-dialog"),V=n("v-container");return d(),c(V,null,{default:l(()=>[t(m),t(f,{justify:"center"},{default:l(()=>[t(v,{text:"为保护媒体资源，如果视频或图片不显示，请点击此按钮"},{activator:l(({props:r})=>[t(p,L({onClick:o[0]||(o[0]=q=>h.addLinkKey()),color:"blue"},r),{default:l(()=>[u(" 加载 ")]),_:2},1040)]),_:1})]),_:1}),t(m),e.showShareRes?(d(),c(S,{key:0},{default:l(()=>[t(y,null,{default:l(()=>[e.item.editType==1?(d(),c(g,{text:e.item.data,key:e.editKey},null,8,["text"])):_("",!0),e.item.editType==0?(d(),c(w,{markdown:e.item.data,speech:!1,key:e.editKey},null,8,["markdown"])):_("",!0)]),_:1})]),_:1})):_("",!0),t(D,{modelValue:e.showShareDialog,"onUpdate:modelValue":o[4]||(o[4]=r=>e.showShareDialog=r),"max-width":"490"},{default:l(()=>[t(S,null,{default:l(()=>[t(k,{class:"headline"},{default:l(()=>[u("请输入密码")]),_:1}),t(y,null,{default:l(()=>[t(f,{justify:"center"},{default:l(()=>[t(m,null,{default:l(()=>[t(x,{modelValue:e.userSeeKey,"onUpdate:modelValue":o[1]||(o[1]=r=>e.userSeeKey=r),placeholder:"密码",label:"密码",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(C,null,{default:l(()=>[t(K),t(p,{color:"green darken-1",text:"",onClick:o[2]||(o[2]=r=>e.showShareDialog=!1)},{default:l(()=>[u(" 放弃 ")]),_:1}),t(p,{color:"error",text:"",onClick:o[3]||(o[3]=r=>h.getShareData())},{default:l(()=>[u(" 确认 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const H=R(U,[["render",T]]);export{H as default};
