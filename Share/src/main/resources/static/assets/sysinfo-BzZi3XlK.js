import{a as j}from"./view-log-list-CvwBN07h.js";import{_ as L,c,w as t,V as P,o as f,g as M,y as A,a as e,b as l,e as n,f as m,x as h,k as d,i as u,aL as w,q as k,C as v,F as x,u as _,j as S,v as D,t as y,z as F,d as p,r as N,aM as b,D as I}from"./index-eEThDJPZ.js";import{V as g,a as T,b as W,c as B}from"./VCard-Cr7mm8p2.js";import{V as G}from"./VTextarea-BoMOnnm0.js";import"./VSelect-I7fLT9OC.js";const q={components:{ViewLogTable:j},data(){return{showAiUserDialog:!1,nowInvitationCode:{id:0},user:{username:"",password:"",oldPassword:""},snackbar:!1,message:"",ipdata:"",items:[{createUser:"mdi-share",ip:"分享列表"},{createUser:"mdi-file",ip:"文件列表"},{createUser:"mdi-text",ip:"二维码分享"},{createUser:"mdi-lock",ip:"加密解密"},{createUser:"mdi-wrench",ip:"设置"},{createUser:"mdi-help",ip:"关于"}],loginUserInfo:{},showSysInfo:!1,showLogin:!0,fileMax:0,aiConfig:"",invitationCodeList:[]}},created(){this.checkLogin()},methods:{seeAiUserlog(i){this.nowInvitationCode=i,this.showAiUserDialog=!0},checkLogin(){this.httpGet("/login/check",i=>{i.status==200?(this.showSysInfo=!0,this.showLogin=!1,this.getWhitelist(),this.getFileMax(),this.getInvitationCode(),this.getAiConfig()):(this.showSysInfo=!1,this.showLogin=!0)})},userLogin(){this.httpPost("/login",this.user,i=>{i.data!=null&&i.data!=""?(this.loginUserInfo=i.data,this.showSysInfo=!0,this.showLogin=!1,this.getWhitelist(),this.getFileMax(),this.getInvitationCode(),this.getAiConfig()):(this.message="登录失败",this.snackbar=!0)})},updatePassword(){this.httpPost("/admin/change/password",this.user,i=>{i.data!=null&&i.data!=""?(this.loginUserInfo=i.data,this.showSysInfo=!1,this.showLogin=!0):(this.message="修改失败",this.snackbar=!0)})},addWhitelIP(){this.httpPost("/admin/whitelist/add",this.ipdata,i=>{console.log(i),this.getWhitelist()})},getWhitelist(){this.httpGet("/admin/whitelist",i=>{this.items=i.data})},deleteIP(i){this.httpPost("/admin/whitelist/delete",i,s=>{this.getWhitelist()})},checkNumber(){return!(this.fileMax==null||isNaN(parseInt(this.fileMax)))},settingFileMax(){this.checkNumber()&&this.httpPost("/upload/setting/filemax?type=sysinfo",{uploadFileMax:this.fileMax},i=>{this.message=i.message,this.snackbar=!0})},getFileMax(){this.httpGet("/upload/disk",i=>{this.fileMax=i.data.uploadFileMax})},submitAiConfig(){const i={configMessage:this.aiConfig};this.httpPost("/ai/save",i,s=>{console.log(s)})},getAiConfig(){this.httpPost("/ai/config",{invitationCode:""},i=>{this.aiConfig=i.data.configMessage})},createCode(){this.httpPost("/ai/invitation",null,i=>{this.getInvitationCode()})},getInvitationCode(){this.httpGet("/ai/invitation/list",i=>{this.invitationCodeList=i.data})},deleteAICode(i){this.httpPost("/ai/invitation/delete",i,s=>{console.log(s),this.getInvitationCode()})}}},z=p("h2",null,"系统配置：",-1),E=p("h2",null,"IP白名单",-1),R=p("h2",null,"修改密码",-1),H=p("h2",null,"上传文件大小配置",-1),J=p("h2",null,"AI 配置",-1);function K(i,s,O,Q,o,r){const U=N("ViewLogTable");return f(),c(P,null,{default:t(()=>[M(e(n,{justify:"center",align:"center"},{default:t(()=>[e(l,null,{default:t(()=>[e(g,{class:"mx-auto",outlined:""},{default:t(()=>[e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"10"},{default:t(()=>[z]),_:1})]),_:1}),e(m),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{modelValue:o.user.username,"onUpdate:modelValue":s[0]||(s[0]=a=>o.user.username=a),placeholder:"账号",label:"账号",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{modelValue:o.user.password,"onUpdate:modelValue":s[1]||(s[1]=a=>o.user.password=a),type:"password",placeholder:"密码",label:"密码",variant:"underlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(d,{onClick:r.userLogin,color:"blue"},{default:t(()=>[u(" 登录 ")]),_:1},8,["onClick"])]),_:1}),e(l)]),_:1})]),_:1})]),_:1},512),[[A,o.showLogin]]),o.showSysInfo?(f(),c(n,{key:0,justify:"center",align:"center"},{default:t(()=>[e(l,null,{default:t(()=>[e(g,{class:"mx-auto",outlined:""},{default:t(()=>[e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"10"},{default:t(()=>[E]),_:1})]),_:1}),e(m),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(w,{density:"compact"},{default:t(()=>[(f(!0),k(x,null,v(o.items,(a,V)=>(f(),c(b,{key:V,value:a,color:"primary"},{prepend:t(()=>[e(d,{color:"error",onClick:C=>r.deleteIP(a),style:{"margin-right":"32px"},density:"compact"},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),default:t(()=>[e(I,null,{default:t(()=>[u(y(a.ip)+" - 创建人："+y(a.createUser),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1}),e(m),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{modelValue:o.ipdata,"onUpdate:modelValue":s[2]||(s[2]=a=>o.ipdata=a),placeholder:"IP",label:"IP",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"4"},{default:t(()=>[e(d,{onClick:r.getWhitelist},{default:t(()=>[u(" 刷新 ")]),_:1},8,["onClick"])]),_:1}),e(l,{cols:"4"},{default:t(()=>[e(d,{onClick:r.addWhitelIP,color:"green"},{default:t(()=>[u(" 增加 ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(l)]),_:1})]),_:1})]),_:1})):_("",!0),o.showSysInfo?(f(),c(n,{key:1,justify:"center",align:"center"},{default:t(()=>[e(l,null,{default:t(()=>[e(g,{class:"mx-auto",outlined:""},{default:t(()=>[e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"10"},{default:t(()=>[R]),_:1})]),_:1}),e(m),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{modelValue:o.user.username,"onUpdate:modelValue":s[3]||(s[3]=a=>o.user.username=a),placeholder:"账号",label:"账号",clearable:"",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{modelValue:o.user.oldPassword,"onUpdate:modelValue":s[4]||(s[4]=a=>o.user.oldPassword=a),type:"password",placeholder:"旧密码",label:"旧密码",variant:"underlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{modelValue:o.user.password,"onUpdate:modelValue":s[5]||(s[5]=a=>o.user.password=a),type:"password",placeholder:"新密码",label:"新密码",variant:"underlined",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(d,{onClick:r.updatePassword},{default:t(()=>[u(" 修改 ")]),_:1},8,["onClick"])]),_:1}),e(l)]),_:1})]),_:1})]),_:1})):_("",!0),o.showSysInfo?(f(),c(n,{key:2,justify:"center",align:"center"},{default:t(()=>[e(l,null,{default:t(()=>[e(g,{class:"mx-auto",outlined:""},{default:t(()=>[e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"10"},{default:t(()=>[H]),_:1})]),_:1}),e(m),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(h,{variant:"underlined",modelValue:o.fileMax,"onUpdate:modelValue":s[6]||(s[6]=a=>o.fileMax=a),placeholder:"上传文件最大大小（单位：M）",label:"上传文件最大大小（单位：M）",clearable:"",rules:[()=>r.checkNumber()||"必须是数字且不为空"]},null,8,["modelValue","rules"])]),_:1}),e(l,{cols:"2"},{default:t(()=>[e(d,{color:"primary",onClick:s[7]||(s[7]=a=>r.settingFileMax())},{default:t(()=>[u("修改")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0),o.showSysInfo?(f(),c(n,{key:3,justify:"center",align:"center"},{default:t(()=>[e(l,null,{default:t(()=>[e(g,{class:"mx-auto",outlined:""},{default:t(()=>[e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"10"},{default:t(()=>[J]),_:1})]),_:1}),e(m),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(G,{label:"配置",modelValue:o.aiConfig,"onUpdate:modelValue":s[8]||(s[8]=a=>o.aiConfig=a),variant:"underlined"},null,8,["modelValue"])]),_:1}),e(l,{cols:"2"},{default:t(()=>[e(d,{color:"primary",onClick:s[9]||(s[9]=a=>r.submitAiConfig())},{default:t(()=>[u("配置")]),_:1})]),_:1})]),_:1}),e(n,{justify:"center"},{default:t(()=>[e(d,{color:"primary",onClick:s[10]||(s[10]=a=>r.createCode())},{default:t(()=>[u("生成邀请码")]),_:1})]),_:1}),e(l),e(n,{justify:"center"},{default:t(()=>[e(l,{cols:"8"},{default:t(()=>[e(w,{density:"compact"},{default:t(()=>[(f(!0),k(x,null,v(o.invitationCodeList,(a,V)=>(f(),c(b,{key:V,value:a,color:"primary"},{prepend:t(()=>[e(d,{color:"error",onClick:C=>r.deleteAICode(a),style:{"margin-right":"32px"},density:"compact"},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"]),e(d,{color:"error",onClick:C=>r.seeAiUserlog(a),style:{"margin-right":"32px"},density:"compact"},{default:t(()=>[u(" 查看使用日志 ")]),_:2},1032,["onClick"])]),default:t(()=>[e(I,null,{default:t(()=>[u(y(a.name),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):_("",!0),e(D,{modelValue:o.showAiUserDialog,"onUpdate:modelValue":s[12]||(s[12]=a=>o.showAiUserDialog=a),"max-width":"1000"},{default:t(()=>[e(g,null,{default:t(()=>[e(T,{class:"headline"},{default:t(()=>[u("邀请码使用记录")]),_:1}),e(W,null,{default:t(()=>[e(U,{target:o.nowInvitationCode.id,types:2},null,8,["target"])]),_:1}),e(B,null,{default:t(()=>[e(S),e(d,{color:"green darken-1",text:"",onClick:s[11]||(s[11]=a=>o.showAiUserDialog=!1)},{default:t(()=>[u(" 关闭 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(F,{modelValue:o.snackbar,"onUpdate:modelValue":s[13]||(s[13]=a=>o.snackbar=a),timeout:3e3,top:!0},{default:t(()=>[u(y(o.message),1)]),_:1},8,["modelValue"])]),_:1})}const te=L(q,[["render",K]]);export{te as default};
